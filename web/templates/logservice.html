<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="/static/css/main.css">
</head>
<body>
    <header>
        <div class="logo">
            <h1>PramaIA LogService</h1>
        </div>
        <nav>
            <ul>
                <li><a href="/dashboard">Dashboard</a></li>
                <li><a href="/dashboard/search">Ricerca</a></li>
                <li><a href="/dashboard/stats">Statistiche</a></li>
                <li><a href="/dashboard/logservice" class="active">LogService</a></li>
                <li><a href="/dashboard/settings">Impostazioni</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="logservice-info">
            <h2>Informazioni sul LogService</h2>
            <div class="info-cards">
                <div class="card">
                    <h3>Stato del Servizio</h3>
                    <p class="status-indicator {{ 'status-active' if status.is_running else 'status-inactive' }}">
                        {{ "Attivo" if status.is_running else "Inattivo" }}
                    </p>
                    <p>Attivo da: {{ status.uptime }}</p>
                </div>
                <div class="card">
                    <h3>Connessioni</h3>
                    <p class="big-number">{{ status.active_connections }}</p>
                    <p>Connessioni totali: {{ status.total_connections }}</p>
                </div>
                <div class="card">
                    <h3>Log ricevuti</h3>
                    <p class="big-number">{{ status.logs_received_today }}</p>
                    <p>Oggi (ultimi 24h)</p>
                </div>
                <div class="card">
                    <h3>Database</h3>
                    <p>Dimensione: {{ status.db_size }}</p>
                    <p>Log totali: {{ status.total_logs }}</p>
                </div>
            </div>
        </section>

        <section class="clients-info">
            <h2>Client Attivi</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Client ID</th>
                            <th>Progetto</th>
                            <th>Modulo</th>
                            <th>Ultimo log</th>
                            <th>Log inviati</th>
                            <th>Stato</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for client in clients %}
                        <tr>
                            <td>{{ client.id }}</td>
                            <td>{{ client.project }}</td>
                            <td>{{ client.module }}</td>
                            <td>{{ client.last_log_time }}</td>
                            <td>{{ client.logs_sent }}</td>
                            <td class="status-{{ client.status }}">{{ client.status }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </section>

        <section class="api-keys">
            <h2>Chiavi API</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Chiave</th>
                            <th>Progetto</th>
                            <th>Creata</th>
                            <th>Ultimo utilizzo</th>
                            <th>Azioni</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for key in api_keys %}
                        <tr>
                            <td>{{ key.name }}</td>
                            <td>{{ key.key_masked }}</td>
                            <td>{{ key.project }}</td>
                            <td>{{ key.created_at }}</td>
                            <td>{{ key.last_used }}</td>
                            <td>
                                <button class="btn-small btn-primary">Rigenera</button>
                                <button class="btn-small btn-danger">Elimina</button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <div class="actions">
                    <button class="btn-primary">Aggiungi Chiave API</button>
                </div>
            </div>
        </section>

        <section class="integration-guide">
            <h2>Guida all'Integrazione</h2>
            <div class="tabs">
                <div class="tab-headers">
                    <button class="tab-btn active" data-tab="js">JavaScript</button>
                    <button class="tab-btn" data-tab="python">Python</button>
                    <button class="tab-btn" data-tab="pdk">PDK</button>
                    <button class="tab-btn" data-tab="server">PramaIAServer</button>
                </div>
                <div class="tab-content">
                    <div class="tab-pane active" id="js">
                        <h3>Integrazione JavaScript</h3>
                        <pre><code>// Installa il client
npm install pramaialog

// Importa e inizializza
const { PramaIALogger, LogLevel, LogProject } = require('pramaialog');

const logger = new PramaIALogger({
    apiKey: "your_api_key",
    project: LogProject.PDK,
    module: "plugin_name",
    host: "http://localhost:8081"
});

// Utilizza il logger
logger.info("Applicazione avviata");
logger.error("Errore durante l'elaborazione", 
    { error: err.message }, 
    { userId: "admin" });
</code></pre>
                    </div>
                    <div class="tab-pane" id="python">
                        <h3>Integrazione Python</h3>
                        <pre><code># Installa il client
pip install pramaialog

# Importa e inizializza
from pramaialog import PramaIALogger, LogLevel, LogProject

logger = PramaIALogger(
    api_key="your_api_key",
    project=LogProject.SERVER,
    module="workflow_service",
    host="http://localhost:8081"
)

# Utilizza il logger
logger.info("Servizio avviato")
logger.error("Errore durante il caricamento", 
    details={"workflow_id": "123", "error": str(e)},
    context={"user_id": "admin"})
</code></pre>
                    </div>
                    <div class="tab-pane" id="pdk">
                        <h3>Integrazione con PDK</h3>
                        <pre><code>// Usa il LogService dal PDK
import { LogService, LogLevel } from '../services/log-service.js';

// Ottieni l'istanza singleton
const logger = LogService.getInstance();

// Ottieni un logger specifico per un modulo
const moduleLogger = logger.getModuleLogger('NomeTuoModulo');

// Usa il logger
moduleLogger.info('Messaggio informativo');
moduleLogger.error('Errore durante l\'elaborazione', 
    { nodeId: 'node-123', error: e.message },
    { workflowId: workflow.id });
</code></pre>
                    </div>
                    <div class="tab-pane" id="server">
                        <h3>Integrazione con PramaIAServer</h3>
                        <pre><code># Configura il logger nel file utils/logging.py
from pramaialog import PramaIALogger, LogLevel, LogProject

# Crea un'istanza globale del logger
logger = PramaIALogger(
    api_key="your_api_key",
    project=LogProject.SERVER,
    module="pramaiaserver",
    host="http://localhost:8081"
)

# Nei tuoi file
from utils.logging import logger

logger.info("API richiesta ricevuta", 
    details={"endpoint": "/api/workflows"},
    context={"user_id": user.id})
</code></pre>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2023 PramaIA LogService</p>
    </footer>

    <script>
        // Tab navigation
        document.addEventListener('DOMContentLoaded', function() {
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabPanes = document.querySelectorAll('.tab-pane');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Remove active class from all buttons and panes
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabPanes.forEach(pane => pane.classList.remove('active'));
                    
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Show corresponding pane
                    const tabId = this.dataset.tab;
                    document.getElementById(tabId).classList.add('active');
                });
            });
        });
    </script>
</body>
</html>
